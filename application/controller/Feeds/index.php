<?phpinclude "../DummyPath.php";include "../JsGrdfunciones.php";include $PathModel."FeedsRepository.php";$db= new PDO($config["db"], $config["username"], $config["password"]);$FeedsRepository   = new FeedsRepository($db);$JSON      = true;$ReImprime = true;$slista ="id,";$slista.="Image_link,Image_title,Image_url,Image_width,Image_height,";$slista.="Imagelink,Permalink,Title,Description,Sourcepermalink,";$slista.="Sourcetitle,Date,Categories";switch($_SERVER["REQUEST_METHOD"]) {     Case "GET":        Redirecciona($PathReingresar);        break;    Case "--": /* TypeAHead*/          $Shearching  = getBufferData();      //$NombreAsignatura =utf8_decode( htmlspecialchars( $_Shearch ['NombreAsignatura'])); // solo funciona en server local      //$NombreAsignatura = $_Shearch ['NombreAsignatura']; // en server solo no hace falta decoficar        $pageIndex = "1"; $pageSize = "10";        $DatosBuscar = array(                      "Image_link" =>  "",                        "Image_title" =>  "",                        "Image_url" =>  "",                        "Image_width" =>  intval(""),                        "Image_height" =>  intval(""),                        "Imagelink" =>  "",                        "Permalink" =>  "",                        "Title" =>  "",                        "Description" =>  "",                        "Sourcepermalink" =>  "",                        "Sourcetitle" =>  "",                        "Date" =>  "",                        "Categories" => "" ,                       "sBuscame"  => $Shearching,                      "pageIndex" => $pageIndex,                      "pageSize"  => $pageSize        );        $TotalReg  = $FeedsRepository->getCountAll($DatosBuscar);        $result    = $FeedsRepository->getAll($DatosBuscar);         //echo json_encode($result);        header("Content-Type: application/json");        echo ImprimeRegistros ( $result, $slista,false  );        break;    Case "_":        getBuffer($_Shearch);        $sCampFiltro = 'Matricula';        $sMatricula  =  "";        if ( isset($_SESSION [$sCampFiltro]) )            $sMatricula = $_SESSION [$sCampFiltro];      //$NombreAsignatura =utf8_decode( htmlspecialchars( $_Shearch ['NombreAsignatura'])); // solo funciona en server local      //$NombreAsignatura = $_Shearch ['NombreAsignatura']; // en server solo no hace falta decoficar        $sCampFiltro = 'sBuscame';        $sBuscame  =  "";        if ( isset($_Shearch [$sCampFiltro]) )            $sBuscame = $_Shearch [$sCampFiltro];                 $sOrdenaMe = "Date"; //Date Title        if ( isset($_Shearch ['sOrdenaMe']) )            $sOrdenaMe = $_Shearch ['sOrdenaMe'];                    $pageIndex = "1";        if ( isset($_Shearch ['pageIndex']) )           $pageIndex = $_Shearch ['pageIndex'];        $pageSize = "10";        if ( isset($_Shearch ['pageSize']) )            $pageSize = $_Shearch ['pageSize'];        $DatosBuscar = array(                      "Image_link" =>  $_Shearch["Image_link"],                        "Image_title" =>  $_Shearch["Image_title"],                        "Image_url" =>  $_Shearch["Image_url"],                        "Image_width" =>  intval($_Shearch["Image_width"]),                        "Image_height" =>  intval($_Shearch["Image_height"]),                        "Imagelink" =>  $_Shearch["Imagelink"],                        "Permalink" =>  $_Shearch["Permalink"],                        "Title" =>  $_Shearch["Title"],                        "Description" =>  $_Shearch["Description"],                        "Sourcepermalink" =>  $_Shearch["Sourcepermalink"],                        "Sourcetitle" =>  $_Shearch["Sourcetitle"],                        "Date" =>  $_Shearch["Date"],                        "Categories" => $_Shearch["Categories" ],                       "sBuscame"  => $sBuscame,                      "sOrdenaMe"  => $sOrdenaMe,                        "pageIndex" => $pageIndex,                      "pageSize"  => $pageSize        );         //header("Content-Type: application/json");         //echo json_encode($result);        $TotalReg  = $FeedsRepository->getCountAll($DatosBuscar);        $result    = $FeedsRepository->getAll($DatosBuscar);        echo ImprimeRegistros ( $result, $slista,true,$TotalReg  );        break;    Case "+":        getBuffer($_ADD);        $sCampFiltro = 'Matricula';        $sMatricula  =  "";        if ( isset($_SESSION [$sCampFiltro]) )            $sMatricula = $_SESSION [$sCampFiltro];        $sCampFiltro = 'Matricula';        $sMatricula  =  "0";        if ( isset($_ADD [$sCampFiltro]) )            $sMatricula = $_ADD [$sCampFiltro];        $result = $FeedsRepository->insert(array(                      "Image_link" =>  $_ADD["Image_link"],                        "Image_title" =>  $_ADD["Image_title"],                        "Image_url" =>  $_ADD["Image_url"],                        "Image_width" =>  intval($_ADD["Image_width"]),                        "Image_height" =>  intval($_ADD["Image_height"]),                        "Imagelink" =>  $_ADD["Imagelink"],                        "Permalink" =>  $_ADD["Permalink"],                        "Title" =>  $_ADD["Title"],                        "Description" =>  $_ADD["Description"],                        "Sourcepermalink" =>  $_ADD["Sourcepermalink"],                        "Sourcetitle" =>  $_ADD["Sourcetitle"],                        "Date" =>  $_ADD["Date"],                        "Categories" => $_ADD["Categories" ]         ));         header("Content-Type: application/json");         //echo json_encode($result);        echo ImprimeObjeto ( $result, $slista );        break;    Case "PUT":        getBuffer($_PUT);        $result = $FeedsRepository->update(array(                      "id"                   => intval($_PUT[ "id"]),                      "Image_link" =>  $_PUT["Image_link"],                        "Image_title" =>  $_PUT["Image_title"],                        "Image_url" =>  $_PUT["Image_url"],                        "Image_width" =>  intval($_PUT["Image_width"]),                        "Image_height" =>  intval($_PUT["Image_height"]),                        "Imagelink" =>  $_PUT["Imagelink"],                        "Permalink" =>  $_PUT["Permalink"],                        "Title" =>  $_PUT["Title"],                        "Description" =>  $_PUT["Description"],                        "Sourcepermalink" =>  $_PUT["Sourcepermalink"],                        "Sourcetitle" =>  $_PUT["Sourcetitle"],                        "Date" =>  $_PUT["Date"],                        "Categories" => $_PUT["Categories" ]         ));         header("Content-Type: application/json");         //echo json_encode($result);        echo ImprimeObjeto ( $result, $slista );        break;    Case "POST":        include $PathModule."viewFeed.php";        $result             = $FeedsRepository->getById(intval($_POST["id"]));        $formFeed  = new viewFeed();        echo $formFeed->ImprimeFeed( $result );        break;    Case "-":        getBuffer($_DEL);        $result = $FeedsRepository->remove(intval($_DEL["id"]));        header("Content-Type: application/json");        echo json_encode($result);        //echo ImprimeObjeto ( $result, $slista );        break;   Case "DEL":        getBuffer($_DEL);        $result = $FeedsRepository->removeAll();        header("Content-Type: application/json");        echo json_encode($result);        //echo ImprimeObjeto ( $result, $slista );        break;         Case "RSS":        getBuffer($_RSS);        //intval($_RSS["sFeed"])         $sCampFiltro = 'sFeed';        $sFeed  =  "https://www.yucatan.com.mx/feed";        if ( isset($_RSS [$sCampFiltro]) )            $sFeed = $_RSS [$sCampFiltro];                    $result = $FeedsRepository->updteRSS( $sFeed );        header("Content-Type: application/json");        echo json_encode($result);        //echo ImprimeObjeto ( $result, $slista );        break;                Case "LECEX":        getBuffer($_ShearchLECEX);        $sCampFiltro = 'Matricula';        $sMatricula  =  "";        if ( isset($_SESSION [$sCampFiltro]) )            $sMatricula = $_SESSION [$sCampFiltro];        $sCampFiltro = 'sBuscame';        $sBuscame  =  "";        if ( isset($_ShearchLECEX [$sCampFiltro]) )            $sBuscame = $_ShearchLECEX [$sCampFiltro];        $pageIndex = "1";        if ( isset($_ShearchLECEX ['pageIndex']) )           $pageIndex = $_ShearchLECEX ['pageIndex'];        $pageSize = "10";        if ( isset($_ShearchLECEX ['pageSize']) )            $pageSize = $_ShearchLECEX ['pageSize'];        $DatosBuscar = array(                      "Image_link" =>  $_ShearchLECEX["Image_link"],                        "Image_title" =>  $_ShearchLECEX["Image_title"],                        "Image_url" =>  $_ShearchLECEX["Image_url"],                        "Image_width" =>  intval($_ShearchLECEX["Image_width"]),                        "Image_height" =>  intval($_ShearchLECEX["Image_height"]),                        "Imagelink" =>  $_ShearchLECEX["Imagelink"],                        "Permalink" =>  $_ShearchLECEX["Permalink"],                        "Title" =>  $_ShearchLECEX["Title"],                        "Description" =>  $_ShearchLECEX["Description"],                        "Sourcepermalink" =>  $_ShearchLECEX["Sourcepermalink"],                        "Sourcetitle" =>  $_ShearchLECEX["Sourcetitle"],                        "Date" =>  $_ShearchLECEX["Date"],                        "Categories" => $_ShearchLECEX["Categories" ],                       "sBuscame" => $sBuscame,                      "pageIndex" => $pageIndex,                      "pageSize" => $pageSize        );         //header("Content-Type: application/json");         //echo json_encode($result);        $TotalReg  = $FeedsRepository->getCountAll($DatosBuscar);        $DatosBuscar ['pageSize'] = $TotalReg ;        $result    = $FeedsRepository->getAll($DatosBuscar);        $JSON = false;        include $PathModule."viewFeed.php";        $formFeed = new viewFeed();        $html= $formFeed->ImprimeListaEnEXcelFeed( $result);        $ReImprime    = false;        break;}$db = null;$FeedsRepository = null; ?>